<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Joshua J. Daymude">

  
  
  
    
  
  <meta name="description" content="&#34;Pool testing&#34; has been getting media attention lately as a technique for stretching our limited supply of COVID-19 test kits while delivering accurate results. In this post, I connect pool testing to the classical k-ary search algorithm and analyze its advantages over traditional testing.">

  
  <link rel="alternate" hreflang="en-us" href="https://jdaymude.github.io/post/pool-testing-is-kary-search/">

  


  
  
  
  <meta name="theme-color" content="#3DAAD9">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" disabled>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark">
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,400italic,700%7CLato:400,400italic,700,700italic%7CSource+Code+Pro&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161914201-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-161914201-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu1dc8deb1865675db905a286e8af9308b_16380_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu1dc8deb1865675db905a286e8af9308b_16380_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://jdaymude.github.io/post/pool-testing-is-kary-search/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@joshdaymude">
  <meta property="twitter:creator" content="@joshdaymude">
  
  <meta property="og:site_name" content="Joshua J. Daymude">
  <meta property="og:url" content="https://jdaymude.github.io/post/pool-testing-is-kary-search/">
  <meta property="og:title" content="Pool Testing is k-ary Search for COVID-19 | Joshua J. Daymude">
  <meta property="og:description" content="&#34;Pool testing&#34; has been getting media attention lately as a technique for stretching our limited supply of COVID-19 test kits while delivering accurate results. In this post, I connect pool testing to the classical k-ary search algorithm and analyze its advantages over traditional testing."><meta property="og:image" content="https://jdaymude.github.io/post/pool-testing-is-kary-search/featured.png">
  <meta property="twitter:image" content="https://jdaymude.github.io/post/pool-testing-is-kary-search/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-07-09T14:04:44-07:00">
    
    <meta property="article:modified_time" content="2020-07-14T11:45:47-07:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jdaymude.github.io/post/pool-testing-is-kary-search/"
  },
  "headline": "Pool Testing is k-ary Search for COVID-19",
  
  "image": [
    "https://jdaymude.github.io/post/pool-testing-is-kary-search/featured.png"
  ],
  
  "datePublished": "2020-07-09T14:04:44-07:00",
  "dateModified": "2020-07-14T11:45:47-07:00",
  
  "author": {
    "@type": "Person",
    "name": "Joshua J. Daymude"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Joshua J. Daymude",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jdaymude.github.io/images/logo_hu1dc8deb1865675db905a286e8af9308b_16380_192x192_fit_lanczos_2.png"
    }
  },
  "description": "\"Pool testing\" has been getting media attention lately as a technique for stretching our limited supply of COVID-19 test kits while delivering accurate results. In this post, I connect pool testing to the classical k-ary search algorithm and analyze its advantages over traditional testing."
}
</script>

  

  


  


  
<script id="progressbar" src="https://cdn.rawgit.com/kimmobrunfeldt/progressbar.js/1.1.0/dist/progressbar.js"></script>


<script id="chroma" src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js"></script>


  <title>Pool Testing is k-ary Search for COVID-19 | Joshua J. Daymude</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="dark">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  






  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu1dc8deb1865675db905a286e8af9308b_16380_0x70_resize_lanczos_2.png" alt="Joshua J. Daymude"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu1dc8deb1865675db905a286e8af9308b_16380_0x70_resize_lanczos_2.png" alt="Joshua J. Daymude"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#courses"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#press"><span>Press</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#reviews"><span>Reviews</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/jdaymude_cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Pool Testing is k-ary Search for COVID-19</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span><a href="/authors/jdaymude/">Joshua J. Daymude</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    July 14, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/teaching/">teaching</a></span>
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 522px;">
  <div style="position: relative">
    <img src="/post/pool-testing-is-kary-search/featured_hu876e62b5141c4511414fb871920ac937_123529_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p>I&rsquo;ve seen a handful of articles in the last week about <em>pool testing</em> and <em>sample pooling</em> for COVID-19.
The gist of this technique is simple: to make our limited supply of test kits (reagents) stretch farther, mix several people&rsquo;s samples together and then test the mixture for COVID-19.
Ideally, if the test comes back negative, everyone in that &ldquo;sample pool&rdquo; could be declared COVID-free using just one test.
Otherwise, if the mixture comes back positive, then additional tests are needed to find the individual positive samples.</p>
<p>I&rsquo;m far from a public health and epidemiology expert, but as an enthusiastic computer scientist I can&rsquo;t help but see <em>binary search</em> (or more generally, $k$-ary search) all over this pool testing technique.
My goal in this post is to draw out this connection, illustrating why the efficiency of $k$-ary search (and of pool testing, by extension) is so attractive.
I&rsquo;ll also do some crude math to explore what happens to pool testing if there are too many infections in the population and how many tests it could actually save.</p>
<p>If you&rsquo;re not interested in any of that but want to know more about pool testing, NPR has a 
<a href="https://www.npr.org/sections/health-shots/2020/07/06/886886255/pooling-coronavirus-tests-can-spare-scarce-supplies-but-theres-a-catch" target="_blank" rel="noopener">short primer</a> and the FDA has put out a 
<a href="https://www.fda.gov/news-events/press-announcements/coronavirus-covid-19-update-facilitating-diagnostic-test-availability-asymptomatic-testing-and" target="_blank" rel="noopener">statement</a> on the topic.
On the other hand, if you&rsquo;re interested in more serious research on the topic, this footnote<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> is for you.</p>
<h2 id="finding-things-fast">Finding Things Fast</h2>
<p>In a <em>search problem</em>, the goal is to find a specific item $x^*$ amidst a whole bunch of possibilities $(x_1, x_2, \ldots, x_n)$.
It&rsquo;s like 
<a href="https://waldo.fandom.com/wiki/Waldo_Wiki" target="_blank" rel="noopener">Where&rsquo;s Waldo</a> if Waldo were $x^*$ and each $x_i$ was a person on the page.
Or, perhaps more practically, it&rsquo;s the way you give your favorite maps app a specific address $x^*$ and it has to find that place&rsquo;s data (latitude/longitude, reviews, etc.) amongst all possible places $x_i$ in its gigantic database.</p>
<p>A not-so-great approach to playing Where&rsquo;s Waldo is to make a list of every person on the page and check them one-by-one to see if they&rsquo;re Waldo.
(This is, perhaps, an entertaining way to play since you get to appreciate all the fun and ridiculous details, but we&rsquo;re going for efficiency here).
In computer science, we call this strategy — or &ldquo;algorithm&rdquo; — <em>brute force search</em>: when all else fails, just try everything.
How bad can this be?
Well, in the worst case Waldo might be the very last person in our list, so we would have had to check all $n$ people before we found him.
So, knowing that the least clever search strategy makes us try $n$ times before we find Waldo, can we do better?</p>
<p>Imagine that you have a friend who already knows where Waldo is and has agreed to help you out by telling you which half of the page he&rsquo;s on (left or right).
Now you only have to search half of the possibilities, or roughly $n/2$ people.
Say your friend&rsquo;s really helpful, and they&rsquo;ll let you do this as many times as you want: they&rsquo;ll keep telling you which half of the remaining section Waldo&rsquo;s in until you find him.
So at first you have $n$ people to look through, then after your friend helps once you have $n/2$, and after helping again you have $n/4$, and then $n/8$, and so on.
In general, if your friend has helped you $i$ times, then you only have $n/(2^i)$ people to look through.
Doing a little algebra, after your friend has helped you $\log_2(n)$ times, you only have $n/(2^{\log_2(n)}) = n/n = 1$ person left, and that person is Waldo.
This strategy is <em>binary search</em>: &ldquo;binary&rdquo; because your friend splits the possibilities in two each time they help.</p>
<p>It may have been a while since you&rsquo;ve brushed up on your logarithms, so let&rsquo;s look at some numbers to get a sense of how fast this is. An average Where&rsquo;s Waldo puzzle has roughly $n = 500$ people on it.
So, if we were to use brute force search, we&rsquo;d be looking through all $n = 500$ people.
However, if we had our helpful friend to do binary search with us, we&rsquo;d only need to ask their help $\log_2(500) \approx 9$ times before we found Waldo!
Not bad, hey?</p>
<p>The key to binary search is in throwing away whole chunks of possibilities all at once, rapidly narrowing our search field.
$k$-ary search is just a generalization, where instead of splitting the possibilities in half each time, we split them into $k$ equal parts. We then keep the $n/k$-sized section containing our target and repeat, requiring a total of $\log_k(n)$ search operations to find our target (which is even faster than binary search!). Before we call it quits with Waldo and get back to pool testing, it&rsquo;s worth pointing out that there are plenty of ways to make searching even faster (especially with parallel algorithms). There are even search algorithms 
<a href="http://www.randalolson.com/2015/02/03/heres-waldo-computing-the-optimal-search-strategy-for-finding-waldo/" target="_blank" rel="noopener">specifically for finding Waldo</a>, if that&rsquo;s your jam.</p>
<h2 id="pool-testing-meet-k-ary-search">Pool Testing, Meet k-ary Search</h2>
<p>Shifting our perspective on testing from personal experience (&ldquo;Have I contracted COVID-19?&quot;) to the population level (&ldquo;Who in our communities are positive?&quot;), we can frame testing as a search problem.
Among all individuals $(x_1, x_2, \ldots, x_n)$, we want to find those $x_i$'s that are positive for COVID-19 so they can isolate and get timely medical care.
In this setting, brute force search would be individually testing every single person — and that&rsquo;s 
<a href="https://www.nytimes.com/2020/07/06/us/coronavirus-test-shortage.html" target="_blank" rel="noopener">way more tests</a> than we have.
The current US strategy of only testing symptomatic cases isn&rsquo;t more &ldquo;efficient&rdquo; than brute force, it&rsquo;s just brute force search on a (hopefully) small subset of the total population.</p>
<p>Pool testing, on the other hand, is similar to $k$-ary search.
Just like our helpful friend telling us which half of the page Waldo isn&rsquo;t on, a single pool test ideally shows us a whole group of people that we can declare COVID-19 negative; in our search for positive cases, we can look elsewhere.</p>





  
  











<figure >


  <a data-fancybox="" href="/post/pool-testing-is-kary-search/pooltest_hub8d5ccf727d58e61b91e4b04452d5a8c_507898_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/pool-testing-is-kary-search/pooltest_hub8d5ccf727d58e61b91e4b04452d5a8c_507898_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="3242" height="1507">
</a>



</figure>

<p>Consider the situation depicted above, with $128$ total individuals needing tests but only $4$ of them COVID-19 positive (shown in red).
If we tested all $128$ people individually (brute force), we would need $128$ tests.
But suppose we could reliably test pools of up to $16$ people at once, as shown in the first row.
Only three of the $128/16 = 8$ pool tests would come back positive, allowing us to immediately rule out $5 \times 16 = 80$ negative individuals.
For the three positive pools, we need to do additional tests to find the positive cases.
This could be done by individually testing everyone in the positive pools<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> — effectively using smaller brute force — requiring $3 \times 16 = 48$ additional tests.
Alternatively (assuming we had enough samples), we could do pool testing again, this time on smaller pools.<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>
So long as there aren&rsquo;t too many positive samples (something we&rsquo;ll revisit shortly), this will help us save on tests: in the picture, we only end up needing $30$ additional tests to handle the $48$ individuals in positive pools.
The table below compares the number of tests used by each testing strategy in this example, along with the number of samples per person required.</p>
<table>
<thead>
<tr>
<th>Testing Strategy</th>
<th>Tests Used</th>
<th>Tests Saved</th>
<th>Samples per Person</th>
</tr>
</thead>
<tbody>
<tr>
<td>Individual (brute force)</td>
<td>$128$</td>
<td>$0\%$</td>
<td>$1$</td>
</tr>
<tr>
<td>Pool Testing (one round)</td>
<td>$56$</td>
<td>$56\%$</td>
<td>$1$</td>
</tr>
<tr>
<td>Pool Testing (repeated)</td>
<td>$38$</td>
<td>$70\%$</td>
<td>$&gt; 1$</td>
</tr>
</tbody>
</table>
<h2 id="what-can-go-wrong">What Can Go Wrong?</h2>
<p>At least a few serious things:</p>
<ul>
<li>Added logistical complications for labs, including tracking which individuals&rsquo; samples are in which pools, added mixing steps, etc.</li>
<li>The possibility of larger <em>false-negative</em> rates (i.e., testing negative when the sample was, in fact, positive) due to samples getting diluted when they&rsquo;re mixed into pools.<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup></li>
<li>A loss of efficiency when there are too many positive samples.</li>
</ul>
<p>For the rest of this post, I&rsquo;m going to focus on that last problem.
Pool testing&rsquo;s strength lies in its ability to rule out large groups of negative cases at once, as we saw in the example.
But with too many positive cases, the likelihood of pools testing positive becomes much higher, requiring a greater number of subsequent tests.
At what point does pool testing end up using more tests than if we just tested everyone individually?</p>
<p>Instead of repeated pool testing (like in our example above), consider the more practical protocol of doing only one round of pool testing and then testing all samples in positive pools individually.
If we have $n$ total samples, our pool size is $p$, and $x$ pool tests come back positive, then we will use a total of $n/p + xp$ tests: $n/p$ pool and $xp$ individual.
Since we&rsquo;d use $n$ tests doing brute force, pool testing only saves us tests if $n/p + xp &lt; n$, or equivalently, if:
$$x &lt; (n/p)(1 - 1/p)$$</p>
<p>To connect the number of positive pools $x$ we&rsquo;ll have based on how many positive cases are in the population, let $r$ be the probability that any given sample is COVID-19 positive.
The probability that a pool of size $p$ contains a positive sample is $1 - (1 - r)^p$.
There are $n/p$ total pools, so the expected (average) number of positive pools is:
$$E[x] = (n/p)(1 - (1 - r)^p)$$
Therefore, we save on tests using pool testing in expectation if:
$$\begin{align*} (n/p)(1 - (1 - r)^p) &amp;&lt; (n/p)(1 - 1/p) \\ r &amp;&lt; 1 - p^{-1/p} \end{align*}$$</p>





  
  











<figure >


  <a data-fancybox="" href="/post/pool-testing-is-kary-search/efficientplot_hubbab132a171178a63e8c403eaeaedda1_112102_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/pool-testing-is-kary-search/efficientplot_hubbab132a171178a63e8c403eaeaedda1_112102_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="1920" height="1440">
</a>



</figure>

<p>The above graph plots this efficient region.
The x-axis is the pool size $p$ and the y-axis is the infection rate $r$.
Any point in the blue region represents a $(p,r)$ pair for which pool testing uses less tests than brute force in expectation.
For example, with a pool size of $p = 16$, our crude math suggests that pool testing is more efficient for infection rates up to, coincidentally, $r \approx 16\%$.
This would be a terrifyingly high infection rate (at the time of this writing, the CDC reports a $\approx 1\%$ 
<a href="https://www.cdc.gov/covid-data-tracker/#cases" target="_blank" rel="noopener">positive case rate</a> in the US), so it seems that in realistic settings even one round of pool testing would save a lot of tests.</p>
<h2 id="taking-our-savings-to-the-bank">Taking Our Savings to the Bank</h2>
<p>To recap, we&rsquo;ve seen how pool testing is related to $k$-ary search, how both of these techniques leverage the ability to rule out large groups of possibilities to narrow things down quickly, and how pool testing will save us tests so long as the infection rate is low enough.
The last thing to nail down is how many tests are actually saved.
From our work above, we know that the expected number of tests saved using one round of pool testing is:
$$\begin{align*} E[\text{# tests saved}] &amp;= \text{# tests for brute force} - E[\text{# tests for pool testing}] \\ &amp;= n - (n/p + E[\text{# positive pools}] \cdot p) \\ &amp;= n - n/p - (n/p)(1 - (1-r)^p)p \\ &amp;= n(-1/p + (1-r)^p) \end{align*}$$
The fraction of tests saved is just the number of tests saved divided by $n$, so a single round of pool testing in pools of size $p$ uses a $(1-r)^p - 1/p$ fraction less tests.
The following plot shows this equation for different pool sizes $p$ as a function of the infection rate $r$.</p>





  
  











<figure >


  <a data-fancybox="" href="/post/pool-testing-is-kary-search/savingsplot_hu0b73f0fe4a2adce77317aafa0603f92a_185079_2000x2000_fit_lanczos_2.png" >


  <img data-src="/post/pool-testing-is-kary-search/savingsplot_hu0b73f0fe4a2adce77317aafa0603f92a_185079_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="1920" height="1440">
</a>



</figure>

<p>This shows that larger pool sizes have the potential for saving more tests, but also degrade in their efficiency more rapidly as the infection rate $r$ grows.
Eventually, if the infection rate becomes too large, all four curves become negative and pool testing ends up using more tests than brute force.
This corresponds to leaving the efficient region shown in the previous graph.
If you&rsquo;re having a hard time interpreting these curves, the following table compares pool testing with $p = 4$ (blue) and $p = 16$ (green).</p>
<table>
<thead>
<tr>
<th>Pool Size</th>
<th>Tests Saved at $r = 1\%$</th>
<th>Tests Saved at $r = 5\%$</th>
<th>Infection Rate for No Savings</th>
</tr>
</thead>
<tbody>
<tr>
<td>$p = 4$</td>
<td>$71\%$</td>
<td>$56\%$</td>
<td>$r = 29\%$</td>
</tr>
<tr>
<td>$p = 16$</td>
<td>$79\%$</td>
<td>$38\%$</td>
<td>$r = 16\%$</td>
</tr>
</tbody>
</table>
<p>The key takeaway is that from a purely test-savings perspective, pool testing does a remarkable job for any reasonable pool size.
While it is true that pool testing can end up using more tests than traditional testing if the infection rate grows too large, my crude math suggests that the infection rate would need to be quite high ($r &gt; 10\%$) before this inefficiency would be noticeable.
At today&rsquo;s US infection rate of $r \approx 1\%$, we could be $70\%$ more efficient with our limited supply of testing reagents, helping more people get tested more often.
Perhaps if this technique were widely used, we would all be that much closer to safely getting on with our lives.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>
<a href="https://jamanetwork.com/journals/jamanetworkopen/fullarticle/2767513" target="_blank" rel="noopener">Cherif et al. 2020</a> detail a recent mathematical model for pool testing and 
<a href="https://academic.oup.com/cid/article/doi/10.1093/cid/ciaa531/5828059" target="_blank" rel="noopener">Yelin et al. 2020</a> characterize its dilution and false-negative rates. The references in the Yelin paper also cover deeper mathematical analysis (e.g., 
<a href="https://projecteuclid.org/euclid.aoms/1177731363" target="_blank" rel="noopener">Dorfman 1943</a>) and how pool testing has been used to combat infectious disease in the past (e.g., for malaria in 
<a href="https://jcm.asm.org/content/48/2/512" target="_blank" rel="noopener">Taylor et al. 2010</a>). <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>From my brief sifting of the literature, practical implementations of pool testing only use one round of pool tests: roughly $65\%$ of each sample is used in a pool test, and the remaining $35\%$ is saved for an individual test in case the pool comes back positive. Repeated pool testing doesn&rsquo;t seem to be used in practice, presumably because it would rely on collecting additional swab samples per person. <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>I&rsquo;ve depicted the subpool tests in a <em>binary</em> search kind of way where each positive pool is split in <em>half</em> and retested, but they could be broken into any number of groups. <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>
<a href="https://academic.oup.com/cid/article/doi/10.1093/cid/ciaa531/5828059" target="_blank" rel="noopener">Yelin et al. 2020</a> estimate that the false-negative rates for pools as large as $16$ or $32$ is roughly $10\%$ based on their experiments. I chose not to do my speculative math for dilution and false-negative rates because I don&rsquo;t understand how PCR tests actually work and don&rsquo;t believe in blindly oversimplifying things for the sake of nice math. <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </div>

    



<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/covid-19/">covid-19</a>
  
  <a class="badge badge-light" href="/tags/pool-testing/">pool-testing</a>
  
  <a class="badge badge-light" href="/tags/search-algorithms/">search-algorithms</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Pool%20Testing%20is%20k-ary%20Search%20for%20COVID-19&amp;body=https://jdaymude.github.io/post/pool-testing-is-kary-search/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jdaymude.github.io/post/pool-testing-is-kary-search/&amp;text=Pool%20Testing%20is%20k-ary%20Search%20for%20COVID-19" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jdaymude.github.io/post/pool-testing-is-kary-search/&amp;t=Pool%20Testing%20is%20k-ary%20Search%20for%20COVID-19" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jdaymude.github.io/post/pool-testing-is-kary-search/&amp;title=Pool%20Testing%20is%20k-ary%20Search%20for%20COVID-19" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://reddit.com/submit?url=https://jdaymude.github.io/post/pool-testing-is-kary-search/&amp;title=Pool%20Testing%20is%20k-ary%20Search%20for%20COVID-19" target="_blank" rel="noopener" class="share-btn-reddit">
          <i class="fab fa-reddit-alien"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/jdaymude/avatar_hu4d7d01c1aaa3ea1eb29c77aa3e89f777_905663_270x270_fill_q90_lanczos_center.jpg" alt="Joshua J. Daymude">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jdaymude.github.io/">Joshua J. Daymude</a></h5>
      <h6 class="card-subtitle">PhD Student, Computer Science</h6>
      <p class="card-text">I am a Christian and computer science PhD student studying emergent behavior and programmable matter through the lens of distributed computing, stochastic processes, and bio-inspired algorithms. I also love gaming and playing music.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/files/jdaymude_cv.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=CQNOJjgAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/joshdaymude" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.instagram.com/joshdaymude" target="_blank" rel="noopener">
        <i class="fab fa-instagram"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jdaymude" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://account.xbox.com/en-us/profile?gamertag=Iltrivosk" target="_blank" rel="noopener">
        <i class="fab fa-xbox"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://steamcommunity.com/id/iltrivosk/" target="_blank" rel="noopener">
        <i class="fab fa-steam"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  










  
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © 2020 Joshua J. Daymude &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
